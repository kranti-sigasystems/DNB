// Auto-generated by merge-prisma.ts
// Generated: 2025-12-22T12:00:00.000Z
// Updated to match actual database structure

generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  // url = env("DATABASE_URL") - Configure in PrismaClient instead
}

// ========== BusinessOwner.prisma ==========
model BusinessOwner {
  id                 String   @id @default(uuid())
  userId             String   @unique
  businessName       String   @unique
  first_name         String?  @map("first_name")
  last_name          String?  @map("last_name")
  email              String   @unique
  phoneNumber        String?  @map("phoneNumber")
  registrationNumber String   @unique @map("registrationNumber")
  country            String
  state              String
  city               String
  address            String
  postalCode         String   @map("postalCode")
  planId             String?  @map("planId")
  paymentId          String?  @map("paymentId")
  status             String   @default("active")
  is_deleted         Boolean  @default(false) @map("is_deleted")
  is_verified        Boolean  @default(false) @map("is_verified")
  is_approved        Boolean  @default(false) @map("is_approved")
  createdAt          DateTime @default(now()) @map("createdAt")
  updatedAt          DateTime @updatedAt @map("updatedAt")

  // Relations
  user          User           @relation(fields: [userId], references: [id], onDelete: Cascade)
  buyers        Buyer[]        // Add buyers relation
  products      Product[]      @relation("BusinessOwnerProducts")
  locations     Location[]     @relation("BusinessOwnerLocations")

  @@map("business_owners")
}

// ========== Buyer.prisma ==========
model Buyer {
  id                 String   @id @default(uuid())
  contactName        String
  email              String   @unique
  contactEmail       String?
  contactPhone       String?
  phoneNumber        String?
  buyersCompanyName  String?
  businessName       String?
  productName        String?
  locationName       String?
  registrationNumber String?  @unique
  address            String?
  city               String?
  state              String?
  country            String   @default("India")
  postalCode         String?
  businessOwnerId    String
  status             String   @default("active")
  is_deleted         Boolean  @default(false) @map("is_deleted")
  createdAt          DateTime @default(now()) @map("createdAt")
  updatedAt          DateTime @updatedAt @map("updatedAt")

  // Relations
  businessOwner BusinessOwner @relation(fields: [businessOwnerId], references: [id], onDelete: Cascade)

  @@map("buyers")
}

// ========== Payment.prisma ==========
model Payment {
  id              String   @id @default(uuid())
  userId          String?
  businessOwnerId String?
  planId          String
  subscriptionId  String?

  amount   Decimal
  currency String? @default("INR")

  status        String? @default("pending")
  paymentMethod String? @default("card")

  transactionId    String? @unique
  invoicePdf       String?
  stripeSessionId  String? @unique
  stripePaymentId  String?
  stripeCustomerId String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User? @relation(fields: [userId], references: [id], onDelete: Cascade)
  plan Plan  @relation(fields: [planId], references: [id])

  @@map("payments")
}

// ========== Subscription.prisma ==========
model Subscription {
  id             String @id @default(uuid())
  userId         String
  subscriptionId String
  planName       String
  status         String
  paymentStatus  String
  startDate      DateTime
  endDate        DateTime?
  maxLocations   Int?
  maxProducts    Int?
  maxOffers      Int?
  maxBuyers      Int?

  // Stripe fields
  stripeSubscriptionId String?   @unique
  stripeCustomerId     String?
  currentPeriodStart   DateTime?
  currentPeriodEnd     DateTime?

  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("subscriptions")
}

// ========== Plan.prisma ==========
model Plan {
  id          String @id @default(uuid())
  key         String @unique
  name        String
  description String @default("")
  currency    String @default("INR")

  priceMonthly Int
  priceYearly  Int

  maxUsers    Int @default(1)
  maxProducts Int @default(50)
  maxOffers   Int @default(100)
  maxBuyers   Int @default(50)

  features  Json @default("[]")
  trialDays Int  @default(0)

  isDefault Boolean @default(false)
  isActive  Boolean @default(true)

  sortOrder Int @default(100)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  payments Payment[]

  @@map("plans")
}

// ========== Product.prisma ==========
model Product {
  id          String   @id @default(uuid())
  code        String
  productName String
  species     String[]
  size        String[]
  sku         String?
  ownerId     String
  createdAt   DateTime @default(now()) @map("createdAt")
  updatedAt   DateTime @updatedAt @map("updatedAt")

  // Relations - using ownerId to match existing table
  businessOwner BusinessOwner @relation("BusinessOwnerProducts", fields: [ownerId], references: [id], onDelete: Cascade)

  @@map("products")
}

// ========== Location.prisma ==========
model Location {
  id           String   @id @default(uuid())
  locationName String?
  city         String
  state        String   // Added required state field
  code         String
  country      String
  address      String?
  postalCode   String?
  ownerId      String
  createdAt    DateTime @default(now()) @map("createdAt")
  updatedAt    DateTime @updatedAt @map("updatedAt")

  // Relations - using ownerId to match existing table
  businessOwner BusinessOwner @relation("BusinessOwnerLocations", fields: [ownerId], references: [id], onDelete: Cascade)

  @@map("locations")
}

// ========== User.prisma ==========
model User {
  id               String   @id @default(uuid())
  first_name       String?  @map("first_name")
  last_name        String?  @map("last_name")
  email            String   @unique
  password         String
  roleId           Int      @map("roleId")
  businessName     String?  @map("businessName")
  created_at       DateTime @default(now()) @map("created_at")
  updated_at       DateTime @updatedAt @map("updated_at")
  stripeCustomerId String?  @map("stripeCustomerId")
  subscriptionId   String?  @map("subscriptionId")

  // Relations
  businessOwner BusinessOwner?
  payments      Payment[]
  subscriptions Subscription[]

  @@map("users")
}