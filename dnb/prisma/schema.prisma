// Auto-generated by merge-prisma.ts
// Generated: 2025-12-18T07:59:10.094Z
// Models: BusinessOwner.prisma, Payment.prisma, Plan.prisma, User.prisma

generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  // url = env("DATABASE_URL") - Configure in PrismaClient instead
}


// ========== BusinessOwner.prisma ==========
model BusinessOwner {
  id                  String      @id @default(uuid())
  userId              String      @unique
  businessName        String      @unique
  first_name          String?     @map("first_name")
  last_name           String?     @map("last_name")
  email               String      @unique
  phoneNumber         String?     @map("phoneNumber")
  registrationNumber  String      @unique @map("registrationNumber")
  country             String
  state               String
  city                String
  address             String
  postalCode          String      @map("postalCode")
  planId              String?     @map("planId")
  paymentId           String?     @map("paymentId")
  status              String      @default("active")
  is_deleted          Boolean     @default(false) @map("is_deleted")
  is_verified         Boolean     @default(false) @map("is_verified")
  is_approved         Boolean     @default(false) @map("is_approved")
  createdAt           DateTime    @default(now()) @map("createdAt")
  updatedAt           DateTime    @updatedAt @map("updatedAt")
  
  // Relations
  user                User        @relation(fields: [userId], references: [id], onDelete: Cascade)
  subscriptions       Subscription[]
  
  @@map("business_owners")
}

// ========== Payment.prisma ==========
model Payment {
  id                    String        @id @default(uuid())
  userId                String
  planId                String
  amount                Int           // Amount in cents
  currency              String        @default("INR")
  status                PaymentStatus @default(PENDING)
  billingCycle          BillingCycle  @default(MONTHLY)
  metadata              Json?
  paidAt                DateTime?
  createdAt             DateTime      @default(now())
  updatedAt             DateTime      @updatedAt
  
  // Relations
  user                  User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  plan                  Plan          @relation(fields: [planId], references: [id])
  
  @@map("payments")
}

model Subscription {
  id                   String            @id @default(uuid())
  userId               String
  planId               String
  businessOwnerId      String?
  status               SubscriptionStatus @default(ACTIVE)
  billingCycle         BillingCycle      @default(MONTHLY)
  startDate            DateTime
  endDate              DateTime
  autoRenew            Boolean           @default(true)
  lastPaymentDate      DateTime?
  cancelledAt          DateTime?
  createdAt            DateTime          @default(now())
  updatedAt            DateTime          @updatedAt
  
  // Relations
  user                 User              @relation(fields: [userId], references: [id], onDelete: Cascade)
  plan                 Plan              @relation(fields: [planId], references: [id])
  businessOwner        BusinessOwner?    @relation(fields: [businessOwnerId], references: [id])
  
  @@map("subscriptions")
}

enum PaymentStatus {
  PENDING
  COMPLETED
  FAILED
  CANCELLED
}

enum BillingCycle {
  MONTHLY
  YEARLY
}

enum SubscriptionStatus {
  ACTIVE
  INACTIVE
  CANCELLED
  PAYMENT_FAILED
}

// ========== Plan.prisma ==========
model Plan {
  id                   String    @id @default(uuid())
  key                  String    @unique
  name                 String
  description          String    @default("")
  currency             String    @default("INR")
  priceMonthly         Int       
  priceYearly          Int       
  maxUsers             Int       @default(1)
  maxProducts          Int       @default(50)
  maxOffers            Int       @default(100)
  maxBuyers            Int       @default(50)
  features             Json      @default("[]")
  trialDays            Int       @default(0)
  isDefault            Boolean   @default(false)
  isActive             Boolean   @default(true)
  sortOrder            Int       @default(100)
  createdAt            DateTime  @default(now())
  updatedAt            DateTime  @updatedAt
  
  // Relations
  payments             Payment[]
  subscriptions        Subscription[]
  
  @@map("plans")
}

// ========== User.prisma ==========
// prisma/models/User.prisma
model User {
  id                String    @id @default(uuid())
  first_name        String?   @map("first_name")
  last_name         String?   @map("last_name")
  email             String    @unique
  password          String
  roleId            Int       @map("roleId")
  businessName      String?   @map("businessName")
  created_at        DateTime  @default(now()) @map("created_at")
  updated_at        DateTime  @updatedAt @map("updated_at")
  stripeCustomerId  String?   @map("stripeCustomerId")
  subscriptionId    String?   @map("subscriptionId")
  
  // Relations
  businessOwner     BusinessOwner?
  payments          Payment[]
  subscriptions     Subscription[]
  
  @@map("users")
}
