model Payment {
  id                    String        @id @default(uuid())
  userId                String
  planId                String
  amount                Int           // Amount in cents
  currency              String        @default("INR")
  status                PaymentStatus @default(PENDING)
  billingCycle          BillingCycle  @default(MONTHLY)
  stripeSessionId       String?       @unique
  stripePaymentIntentId String?       @unique
  stripeSubscriptionId  String?
  metadata              Json?
  paidAt                DateTime?
  createdAt             DateTime      @default(now())
  updatedAt             DateTime      @updatedAt
  
  // Relations
  user                  User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  plan                  Plan          @relation(fields: [planId], references: [id])
  
  @@map("payments")
}

model Subscription {
  id                   String            @id @default(uuid())
  userId               String
  planId               String
  businessOwnerId      String?
  status               SubscriptionStatus @default(ACTIVE)
  billingCycle         BillingCycle      @default(MONTHLY)
  startDate            DateTime
  endDate              DateTime
  stripeSubscriptionId String?           @unique
  autoRenew            Boolean           @default(true)
  lastPaymentDate      DateTime?
  cancelledAt          DateTime?
  createdAt            DateTime          @default(now())
  updatedAt            DateTime          @updatedAt
  
  // Relations
  user                 User              @relation(fields: [userId], references: [id], onDelete: Cascade)
  plan                 Plan              @relation(fields: [planId], references: [id])
  businessOwner        BusinessOwner?    @relation(fields: [businessOwnerId], references: [id])
  
  @@map("subscriptions")
}

enum PaymentStatus {
  PENDING
  COMPLETED
  FAILED
  CANCELLED
}

enum BillingCycle {
  MONTHLY
  YEARLY
}

enum SubscriptionStatus {
  ACTIVE
  INACTIVE
  CANCELLED
  PAYMENT_FAILED
}